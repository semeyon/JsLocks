var Locker=function(){};Locker.locks={},Locker._lockQueue={},Locker._runningQueue={},Locker._wait=function(n){var i,t;if(Locker._runningQueue[n]=!0,i=Locker.locks[n],!i){if(Locker.locks[n]=!0,t=Locker._lockQueue[n].shift(),t===undefined){Locker.locks[n]=!1,Locker._runningQueue[n]=!1;return}t[0].call(this),Locker.locks[n]=!1}setTimeout(function(){Locker._wait(n)},20)},Locker._waitManual=function(n){var i,t;if(Locker._runningQueue[n]=!0,i=Locker.locks[n],!i){if(t=Locker._lockQueue[n].shift(),t===undefined){Locker._runningQueue[n]=!1;return}Locker.locks[n]=!0,t[0].call(this)}setTimeout(function(){Locker._waitManual(n)},20)},Locker._prioritizeQueue=function(n){t=Locker._lockQueue[n].sort(function(n,t){return n[1]-t[1]});Locker._lockQueue[n].length===t.length?Locker._lockQueue[n]=t:Locker._prioritizeQueue(n)},Locker.Lock=function(n,t,i){i===undefined&&(i=10),Locker.locks[n]===undefined?(Locker.locks[n]=!0,t.call(this),Locker.locks[n]=!1):(Locker._lockQueue[n]===undefined&&(Locker._lockQueue[n]=[]),Locker._runningQueue[n]===undefined&&(Locker._runningQueue[n]=!1),Locker._lockQueue[n].push([t,i]),Locker._prioritizeQueue(n),Locker._runningQueue[n]||Locker._wait(n))},Locker.LockManual=function(n,t,i){i===undefined&&(i=10),Locker.locks[n]===undefined&&(Locker.locks[n]=!1),Locker._lockQueue[n]===undefined&&(Locker._lockQueue[n]=[]),Locker._runningQueue[n]===undefined&&(Locker._runningQueue[n]=!1),Locker._lockQueue[n].push([t,i]),Locker._prioritizeQueue(n),Locker._runningQueue[n]||Locker._waitManual(n)},Locker.Release=function(n){Locker.locks[n]=!1};
